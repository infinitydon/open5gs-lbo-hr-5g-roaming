apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ .Release.Name }}-pcf-config
  labels:
    epc-mode: pcf
data:
  pcf.yaml: |
    global:
      max:
        ue: 1024  
    logger:
        file:
          path: /var/log/open5gs/pcf.log    
    db_uri: mongodb://{{ .Values.sbiAddresses.mongodb }}/open5gs
    pcf:
      default:
        tls:
          server:
            scheme: https
            private_key: /tls/tls.key
            cert: /tls/tls.crt
            verify_client: true
            verify_client_cacert: /tls/ca.crt
          client:
            scheme: https
            cacert: /tls/ca.crt
            client_private_key: /tls/tls.key
            client_cert: /tls/tls.crt
      sbi:
        server:
        - dev: sbi
          advertise: pcf.5gc.mnc{{ .Values.localPLMN.mnc }}.mcc{{ .Values.localPLMN.mcc }}.3gppnetwork.org
        client:
          scp:
          - uri: https://scp.5gc.mnc{{ .Values.localPLMN.mnc }}.mcc{{ .Values.localPLMN.mcc }}.3gppnetwork.org:7777
      metrics:
        server:
          - dev: eth0
            port: 9090
      policy:
        - supi_range:
            - 999070000000001-999070999999999
          slice:
            - sst: 1  # 1,2,3,4
              default_indicator: true
              session:
                - name: internet
                  type: 3  # 1:IPv4, 2:IPv6, 3:IPv4v6
                  ambr:
                    downlink:
                      value: 1
                      unit: 3  # 0:bps, 1:Kbps, 2:Mbps, 3:Gbps, 4:Tbps
                    uplink:
                      value: 1
                      unit: 3
                  qos:
                    index: 9  # 1, 2, 3, 4, 65, 66, 67, 75, 71, 72, 73, 74, 76, 5, 6, 7, 8, 9, 69, 70, 79, 80, 82, 83, 84, 85, 86
                    arp:
                      priority_level: 8  # 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15
                      pre_emption_vulnerability: 1  # 1: Disabled, 2:Enabled
                      pre_emption_capability: 1  # 1: Disabled, 2:Enabled
                - name: ims
                  type: 3  # 1:IPv4, 2:IPv6, 3:IPv4v6
                  ambr:
                    downlink:
                      value: 1
                      unit: 3  # 0:bps, 1:Kbps, 2:Mbps, 3:Gbps, 4:Tbps
                    uplink:
                      value: 1
                      unit: 3  # 0:bps, 1:Kbps, 2:Mbps, 3:Gbps, 4:Tbps
                  qos:
                    index: 5  # 1, 2, 3, 4, 65, 66, 67, 75, 71, 72, 73, 74, 76, 5, 6, 7, 8, 9, 69, 70, 79, 80, 82, 83, 84, 85, 86
                    arp:
                      priority_level: 1  # 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15
                      pre_emption_vulnerability: 1  # 1: Disabled, 2:Enabled
                      pre_emption_capability: 1  # 1: Disabled, 2:Enabled
                  pcc_rule:
                    - qos:
                        index: 1  # 1, 2, 3, 4, 65, 66, 67, 75, 71, 72, 73, 74, 76, 5, 6, 7, 8, 9, 69, 70, 79, 80, 82, 83, 84, 85, 86
                        arp:
                          priority_level: 1  # 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15
                          pre_emption_vulnerability: 1   # 1: Disabled, 2:Enabled
                          pre_emption_capability: 1   # 1: Disabled, 2:Enabled
                        mbr:
                          downlink:
                            value: 82
                            unit: 1  # 0:bps, 1:Kbps, 2:Mbps, 3:Gbps, 4:Tbps
                          uplink:
                            value: 82
                            unit: 1  # 0:bps, 1:Kbps, 2:Mbps, 3:Gbps, 4:Tbps
                        gbr:
                          downlink:
                            value: 82
                            unit: 1  # 0:bps, 1:Kbps, 2:Mbps, 3:Gbps, 4:Tbps
                          uplink:
                            value: 82
                            unit: 1  # 0:bps, 1:Kbps, 2:Mbps, 3:Gbps, 4:Tbps
                    - qos:
                        index: 2  # 1, 2, 3, 4, 65, 66, 67, 75, 71, 72, 73, 74, 76, 5, 6, 7, 8, 9, 69, 70, 79, 80, 82, 83, 84, 85, 86
                        arp:
                          priority_level: 4  # 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15
                          pre_emption_vulnerability: 2   # 1: Disabled, 2:Enabled
                          pre_emption_capability: 2   # 1: Disabled, 2:Enabled
                        mbr:
                          downlink:
                            value: 802
                            unit: 1  # 0:bps, 1:Kbps, 2:Mbps, 3:Gbps, 4:Tbps
                          uplink:
                            value: 802
                            unit: 1  # 0:bps, 1:Kbps, 2:Mbps, 3:Gbps, 4:Tbps
                        gbr:
                          downlink:
                            value: 802
                            unit: 1  # 0:bps, 1:Kbps, 2:Mbps, 3:Gbps, 4:Tbps
                          uplink:
                            value: 802
                            unit: 1  # 0:bps, 1:Kbps, 2:Mbps, 3:Gbps, 4:Tbps